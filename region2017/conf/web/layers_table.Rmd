---
#csl: nature.csl
bibliography: OHI_Hawaii.bib
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
## Create layers_table.Rmd from EXCEL file for MHI
## like http://ohi-science.org/ohi-global/layers_table.html

library(tidyverse)
library(stringr)

## layers directories locally relative to region2017/conf/web and on github
dir_layers_gh <- "https://github.com/OHI-Science/mhi/blob/master/region2017/layers"

## read in excel sheet from github.com (so make sure that you push any updates)
prep_data_layers <- "https://raw.githubusercontent.com/OHI-Science/mhi/master/prep/data_layers.csv"
data_layers <- readr::read_csv(prep_data_layers) 


## rename a few columns
layers_info <- data_layers %>%
  dplyr::select(header_layer = `Data Layer`,
                layer_name   = Name,
                Description  = `Brief Description`,
                reference    = Reference,
                Dimension    = Goal,
                filename     = File,
                bib, 
                url) %>%
  arrange(layer_name)

info_for_kable <- layers_info %>%
  mutate(Layer = sprintf("[%s](%s/%s)", header_layer, dir_layers_gh, filename),
         Reference   = paste0("@", bib)) %>%
  select(Layer, Description, Dimension, Reference)


##TODO EVA
##update bib column, refs, descriptions of data_layers.csv
##TODO JULIE
##arrange by dimension: all goals then press/resil
##create gh-pages' layers_table with front matter and slurp this in

knitr::kable(info_for_kable)
readr::write_csv(info_for_kable, 'layers_table.csv') # use relative filepath to this RMarkdown doc

```

### References

<!---
# Layer	| Description |	Dimension |	References |
#   ------|-------------|-----------|--------------|
#   [data_layers.csv's Data Layer @seltenrich_scaling_2016 |
# data_layers.csv's Brief Description |
#      Dimesntion |
#      Refs
--->

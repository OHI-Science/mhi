suppressPackageStartupMessages({
  library(readr)
  library(dplyr)
  library(tidyr)
  library(stringr)
  library(sp)
  library(geojsonio)
  library(leaflet)
  library(htmltools)
  library(DT)
  library(knitr)
  library(printr)  # devtools::install_github('yihui/printr')
  library(ohicore) # devtools::install_github('ohi-science/ohicore')
})

## brewed vars
study_area      = "Main Hawaiian Islands"
gh_repo         = "mhi"
gh_branch_data  = "master"
scenario_dir    = "region2017"

# derived vars
dir_data        = sprintf('%s_%s', gh_repo, gh_branch_data)
dir_scenario    = sprintf('%s/%s', dir_data, scenario_dir)
gh_url          = sprintf('https://github.com/OHI-Science/%s.git', gh_repo)
dir_report      = sprintf('%s/global2016/Reporting', dir_data)

# knitr options
knitr::opts_chunk$set(echo = F, message = F, warning = F)

run_cmd = function(cmd){
   system.time(system(cmd))
 }

 # data branch: fetch existing, or clone new
if (!file.exists(dir_data)){

  # clone data branch, shallowly and quietly
  run_cmd(sprintf('git clone -q --depth 1 --branch %s %s %s', gh_branch_data, gh_url, dir_data))

} else {

  # git fetch & overwrite
  run_cmd(sprintf('cd %s; git fetch -q; git reset -q --hard origin/%s; git checkout -q %s; git pull -q', dir_data, gh_branch_data, gh_branch_data))

}

# read config
config = new.env()
source(file.path(dir_scenario, 'conf/config.R'), config)


